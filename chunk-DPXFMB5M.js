import{a as ge,b as _e}from"./chunk-E5DQ37GQ.js";import{a as re}from"./chunk-4IJCF66K.js";import{d as z}from"./chunk-GMAE3TWP.js";import{a as Z}from"./chunk-5CFZ7USD.js";import{a as ie,b as ne}from"./chunk-XD65DFTX.js";import{a as se}from"./chunk-KYDLVRIQ.js";import{a as ue}from"./chunk-B52FSEI7.js";import{a as le,b as me,c as pe}from"./chunk-3CQKWVPW.js";import{d as ae,e as oe,f as de,g as ce}from"./chunk-L44P52BQ.js";import{b as ee,c as te}from"./chunk-JLPIB5B6.js";import"./chunk-X4SNFC5H.js";import{A as Y,e as L,i as j,z as X}from"./chunk-RWOU77EA.js";import"./chunk-XSSXK7EZ.js";import{d as G,e as K,g as Q,l as U}from"./chunk-RRIUMA4F.js";import"./chunk-LLONOUOZ.js";import"./chunk-LPI7DW4Z.js";import"./chunk-2AQ67VSH.js";import{$a as h,Ab as $,Bb as F,Ca as l,Cb as q,Kb as c,Lb as g,Mb as S,Ta as v,V as C,Va as p,Ya as P,Z as A,_a as I,ab as w,bb as T,cb as r,db as n,eb as E,ha as _,ia as f,ib as b,jb as x,kb as d,pc as R,rb as O,sb as o,sc as H,tb as u,ub as N,uc as J,wb as M,xb as D,yb as B,zb as W}from"./chunk-QG64PWEM.js";var fe=()=>({width:"100%",right:"0",left:"0"}),ye=t=>({"920px":t}),ve=()=>({width:"40rem",height:"17rem"});function Ce(t,m){t&1&&(r(0,"small",35),o(1,"Assign Employee is required"),n())}function xe(t,m){if(t&1&&(r(0,"span",26),o(1),c(2,"na"),n()),t&2){let s=d().$implicit;l(),u(g(2,1,s.name))}}function ke(t,m){if(t&1&&v(0,xe,3,3,"span",36),t&2){let s=m.$implicit,i=d();p("ngIf",s.id===i.view.createdByEmployee)}}function be(t,m){if(t&1&&(r(0,"span",26),o(1),c(2,"na"),n()),t&2){let s=d().$implicit;l(),u(g(2,1,s.name))}}function he(t,m){if(t&1&&v(0,be,3,3,"span",36),t&2){let s=m.$implicit,i=d();p("ngIf",s.id===i.view.assignedToEmployee)}}function we(t,m){if(t&1&&(r(0,"span",26),o(1),c(2,"na"),n()),t&2){let s=d().$implicit;l(),u(g(2,1,s.name))}}function Te(t,m){if(t&1&&v(0,we,3,3,"span",36),t&2){let s=m.$implicit,i=d();p("ngIf",s.id===i.view.parentCategoryId)}}function Ee(t,m){if(t&1&&(r(0,"span",26),o(1),c(2,"na"),n()),t&2){let s=d().$implicit;l(),u(g(2,1,s.name))}}function Se(t,m){if(t&1&&v(0,Ee,3,3,"span",36),t&2){let s=m.$implicit,i=d();p("ngIf",s.id===i.view.childCategoryId)}}function Ve(t,m){if(t&1&&(r(0,"span",26),o(1),c(2,"na"),n()),t&2){let s=d().$implicit;l(),u(g(2,1,s.name))}}function Ie(t,m){if(t&1&&v(0,Ve,3,3,"span",36),t&2){let s=m.$implicit,i=d();p("ngIf",s.id===i.view.deptId)}}function Me(t,m){if(t&1){let s=b();r(0,"p-button",37),x("onClick",function(){_(s);let e=d();return f(e.isdialogv(e.view))}),n()}t&2&&p("outlined",!0)}function De(t,m){if(t&1){let s=b();r(0,"p-button",38),x("onClick",function(){_(s);let e=d();return f(e.starttkt(e.view._id))}),n()}t&2&&p("outlined",!0)}function Be(t,m){if(t&1){let s=b();r(0,"p-button",39),x("onClick",function(){_(s);let e=d();return f(e.closetkt(e.view._id))}),n()}t&2&&p("outlined",!0)}function Fe(t,m){if(t&1){let s=b();r(0,"p-button",41),x("onClick",function(){_(s);let e=d(2);return f(e.closetkt(e.view._id))}),n()}}function Le(t,m){if(t&1&&v(0,Fe,1,0,"p-button",40),t&2){let s=d();I(s.view.status!=="Closed"?0:-1)}}function je(t,m){if(t&1){let s=b();r(0,"p-button",42),x("onClick",function(){_(s);let e=d();return f(e.deletetkt(e.view._id))}),n()}t&2&&p("outlined",!1)}var dt=(()=>{let m=class m{constructor(){this.empList=[],this.deptlist=[],this.pcategoryList=[],this.categoryList=[],this.user=JSON.parse(localStorage.getItem("user")||""),this.isdialog=!1,this.view=JSON.parse(localStorage.getItem("ticket")||""),this.ticketObj={id:"",assignedToEmployee:""},this.dept=C(se),this.emp=C(Z),this.catgory=C(ue),this.ticket=C(re),this.message=C(j),this.confirm=C(L),this.router=C(z)}ngOnInit(){this.getEmployee(),this.getDept(),this.getPcategory(),this.getChildcategory()}getSeverity(){switch(this.view.status){case"Open":return"info";case"Assigned":return"secondary";case"In Progress":return"warning";case"Closed":return"success";default:return}}reset(){this.ticketObj.assignedToEmployee=""}isdialogv(i){this.ticketObj.id=i._id,this.isdialog=!0}getEmployee(){this.emp.getEmployees().subscribe(i=>{i.result?this.empList=i.data.map(e=>({id:e._id,empId:e.userId,name:e.name})):this.message.add({severity:"error",summary:"Error",detail:i.message})})}getDept(){this.dept.getDept().subscribe(i=>{i.result?i.data.forEach(e=>{this.deptlist.push({id:e._id,name:e.deptName})}):this.message.add({severity:"error",summary:"Error",detail:i.message})})}getPcategory(){this.catgory.getParentCategories().subscribe(i=>{i.result?i.data.forEach(e=>{this.pcategoryList.push({id:e._id,name:e.categoryName})}):this.message.add({severity:"error",summary:"Error",detail:i.message})})}getChildcategory(){this.catgory.getChildCategories().subscribe(i=>{i.result?i.data.forEach(e=>{this.categoryList.push({id:e._id,name:e.categoryName})}):this.message.add({severity:"error",summary:"Error",detail:i.message})})}assignTicket(){this.ticket.assignTicket(this.ticketObj).subscribe({next:i=>{this.isdialog=!1,i.result?(this.message.add({severity:"success",summary:"Success",detail:"Ticket Assigned Successfully"}),setTimeout(()=>{this.router.navigate(["/pages/tickets"])},1e3)):this.message.add({severity:"error",summary:"Error",detail:i.message})},error:i=>{if(this.message.add({severity:"error",summary:"error",detail:i.error.message}),i.error.data)for(let e of i.error.data)this.message.add({severity:"error",summary:"error",detail:e.msg+" "+e.path})}})}starttkt(i){this.ticket.startTicket(i).subscribe({next:e=>{e.result?(this.message.add({severity:"success",summary:"Success",detail:"Ticket Started Successfully"}),setTimeout(()=>{this.router.navigate(["/pages/tickets"])},1e3)):this.message.add({severity:"error",summary:"Error",detail:e.message})},error:e=>{if(this.message.add({severity:"error",summary:"error",detail:e.error.message}),e.error.data)for(let a of e.error.data)this.message.add({severity:"error",summary:"error",detail:a.msg+" "+a.path})}})}closetkt(i){this.ticket.closeTicket(i).subscribe({next:e=>{e.result?(this.message.add({severity:"success",summary:"Success",detail:"Ticket Closed Successfully"}),setTimeout(()=>{this.router.navigate(["/pages/tickets"])},1e3)):this.message.add({severity:"error",summary:"Error",detail:e.message})},error:e=>{if(this.message.add({severity:"error",summary:"error",detail:e.error.message}),e.error.data)for(let a of e.error.data)this.message.add({severity:"error",summary:"error",detail:a.msg+" "+a.path})}})}deletetkt(i){this.confirm.confirm({header:"Confirmation",message:"Are you sure you want to delete this ticket?",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.ticket.deleteTicket(i).subscribe({next:e=>{e.result?(this.message.add({severity:"success",summary:"Success",detail:"Ticket Deleted Successfully"}),setTimeout(()=>{this.router.navigate(["/pages/tickets"])},1e3)):this.message.add({severity:"error",summary:"Error",detail:e.message})},error:e=>{if(this.message.add({severity:"error",summary:"error",detail:e.error.message}),e.error.data)for(let a of e.error.data)this.message.add({severity:"error",summary:"error",detail:a.msg+" "+a.path})}})},reject:()=>{this.message.add({severity:"info",summary:"Info",detail:"Delete Cancelled"})}})}};m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=A({type:m,selectors:[["app-ticket-view"]],standalone:!0,features:[W([j,L]),$],decls:107,vars:47,consts:[["assign","ngModel"],[3,"breakpoints"],[1,"col-md-12","grid","align-item-center","justify-content-between"],[1,"flex","flex-column","gap-2"],[1,"text-900","font-medium","text-3xl"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/pages/dashboard",1,"text-decoration-none","text-900","font-medium"],["routerLink","/pages/tickets",1,"text-decoration-none","text-900","font-medium"],["aria-current","page",1,"breadcrumb-item","active"],["header","Assign Employee",3,"visibleChange","visible","modal","responsive"],[1,"d-flex","flex-row","gap-2","align-items-center"],["for","assign_emp",1,"font-semibold","w-7rem"],["placeholder","Select Employee","optionLabel","name","optionValue","id","ngModel","","required","",3,"ngModelChange","options","ngModel"],["class","p-error",4,"ngIf"],[1,"flex","justify-content-end","gap-2","mt-4"],["label","Reset","severity","secondary",3,"onClick"],["label","Assign",3,"onClick","disabled"],[1,"col-md-12","mt-4"],[1,"grid","row"],[1,"col-md-12","relative","flex","gap-3","p-3","surface-50","border-round","justify-content-center"],["icon","pi pi-ticket","shape","circle"],[1,"text-lg","font-medium","text-900","mt-1"],[1,"row","mt-4","gap-2","md:gap-3"],[1,"col-md-12","flex","flex-column","gap-2","mb-2"],[1,"font-semibold"],[1,"text"],[1,"col-lg-5","col-md-5","flex","flex-row","gap-3","sm:gap-0"],[1,"font-semibold","col-md-5","col-sm-4"],[3,"value","severity"],[1,"mt-3","align-content-center","justify-content-center","flex","flex-row","gap-2"],["label","Assign",3,"outlined","onClick",4,"ngIf"],["label","Start",3,"outlined","onClick",4,"ngIf"],["label","Complete","severity","success",3,"outlined","onClick",4,"ngIf"],["label","Delete","severity","danger",3,"outlined","onClick",4,"ngIf"],[1,"p-error"],["class","text",4,"ngIf"],["label","Assign",3,"onClick","outlined"],["label","Start",3,"onClick","outlined"],["label","Complete","severity","success",3,"onClick","outlined"],["label","close"],["label","close",3,"onClick"],["label","Delete","severity","danger",3,"onClick","outlined"]],template:function(e,a){if(e&1){let y=b();r(0,"main"),E(1,"p-toast",1)(2,"p-confirmDialog"),r(3,"div",2)(4,"div",3)(5,"span",4),o(6,"Ticket"),n(),r(7,"ol",5)(8,"li",6)(9,"a",7),o(10,"Home"),n()(),r(11,"li",6)(12,"a",8),o(13,"Tickets"),n()(),r(14,"li",9),o(15,"View Ticket"),n()()()(),r(16,"p-dialog",10),B("visibleChange",function(k){return _(y),D(a.isdialog,k)||(a.isdialog=k),f(k)}),o(17," ."),r(18,"div",11)(19,"label",12),o(20,"Department Id"),n(),r(21,"p-dropdown",13,0),B("ngModelChange",function(k){return _(y),D(a.ticketObj.assignedToEmployee,k)||(a.ticketObj.assignedToEmployee=k),f(k)}),n(),v(23,Ce,2,0,"small",14),n(),r(24,"div",15)(25,"p-button",16),x("onClick",function(){return _(y),f(a.reset())}),n(),r(26,"p-button",17),x("onClick",function(){return _(y),f(a.assignTicket())}),n()()(),r(27,"div",18)(28,"div",19)(29,"div",20),E(30,"p-avatar",21),r(31,"div",22),o(32),n()(),r(33,"div",23)(34,"div",24)(35,"label",25),o(36,"Request Details : "),n(),r(37,"span",26),o(38),n()(),r(39,"div",27)(40,"label",28),o(41,"Created By : "),n(),w(42,ke,1,1,"span",26,h),n(),r(44,"div",27)(45,"label",28),o(46,"Assigned To : "),n(),w(47,he,1,1,"span",26,h),n(),r(49,"div",27)(50,"label",28),o(51,"Parent Category : "),n(),w(52,Te,1,1,"span",26,h),n(),r(54,"div",27)(55,"label",28),o(56,"Child Category : "),n(),w(57,Se,1,1,"span",26,h),n(),r(59,"div",27)(60,"label",28),o(61,"Department : "),n(),w(62,Ie,1,1,"span",26,h),n(),r(64,"div",27)(65,"label",28),o(66,"Contact : "),n(),r(67,"span",26),o(68),c(69,"na"),n()(),r(70,"div",27)(71,"label",28),o(72,"Priority : "),n(),r(73,"span",26),o(74),c(75,"na"),n()(),r(76,"div",27)(77,"label",28),o(78,"Created At : "),n(),r(79,"span",26),o(80),c(81,"date"),c(82,"na"),n()(),r(83,"div",27)(84,"label",28),o(85,"Expected By : "),n(),r(86,"span",26),o(87),c(88,"date"),c(89,"na"),n()(),r(90,"div",27)(91,"label",28),o(92,"Complete At : "),n(),r(93,"span",26),o(94),c(95,"date"),c(96,"na"),n()(),r(97,"div",27)(98,"label",28),o(99,"Status : "),n(),E(100,"p-tag",29),n()(),r(101,"div",30),v(102,Me,1,1,"p-button",31)(103,De,1,1,"p-button",32)(104,Be,1,1,"p-button",33)(105,Le,1,1)(106,je,1,1,"p-button",34),n()()()()}if(e&2){let y=O(22);l(),p("breakpoints",q(44,ye,F(43,fe))),l(15),P(F(46,ve)),M("visible",a.isdialog),p("modal",!0)("responsive",!0),l(5),p("options",a.empList),M("ngModel",a.ticketObj.assignedToEmployee),l(2),p("ngIf",y.invalid&&(y.dirty||y.touched)),l(3),p("disabled",y.invalid),l(6),N(" ",a.view.ticketNo," "),l(6),u(a.view.requestDetails),l(4),T(a.empList),l(5),T(a.empList),l(5),T(a.pcategoryList),l(5),T(a.categoryList),l(5),T(a.deptlist),l(6),u(g(69,24,a.view.contactNo)),l(6),u(g(75,26,a.view.severity)),l(6),u(g(82,31,S(81,28,a.view.createdDate,"dd-MMM-yyyy"))),l(7),u(g(89,36,S(88,33,a.view.expectedEndDate,"dd-MMM-yyyy"))),l(7),u(g(96,41,S(95,38,a.view.completedDate,"dd-MMM-yyyy"))),l(6),p("value",a.view.status)("severity",a.getSeverity()),l(2),p("ngIf",a.view.status==="Open"&&(a.user.role==="Department Head"||a.user.role==="superadmin")),l(),p("ngIf",a.view.status==="Assigned"),l(),p("ngIf",a.view.status==="In Progress"),l(),I(a.user.role==="Department Head"||a.user.role==="superadmin"?105:-1),l(),p("ngIf",a.user.role==="superadmin")}},dependencies:[J,R,H,Y,X,le,U,G,Q,K,te,ee,ce,de,pe,me,oe,ae,_e,ge,ne,ie]});let t=m;return t})();export{dt as TicketViewComponent};
