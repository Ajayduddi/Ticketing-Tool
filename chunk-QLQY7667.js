import{a as ce}from"./chunk-4IJCF66K.js";import{d as Q}from"./chunk-GMAE3TWP.js";import{a as de}from"./chunk-5CFZ7USD.js";import{a as ue}from"./chunk-KYDLVRIQ.js";import{a as _e}from"./chunk-B52FSEI7.js";import{a as ye,b as fe}from"./chunk-Z2JUUHCF.js";import{d as pe,e as ge,f as he,g as ve}from"./chunk-L44P52BQ.js";import{c as V}from"./chunk-SSQJ3YUY.js";import{b as se,c as me}from"./chunk-JLPIB5B6.js";import"./chunk-X4SNFC5H.js";import{b as oe}from"./chunk-BS5ZSUXQ.js";import{A as le,e as O,i as L,k as re,z as ae}from"./chunk-RWOU77EA.js";import"./chunk-XSSXK7EZ.js";import{b as X,c as Z,d as $,e as N,f as ee,g as te,i as ie,l as ne}from"./chunk-RRIUMA4F.js";import"./chunk-LLONOUOZ.js";import"./chunk-LPI7DW4Z.js";import"./chunk-2AQ67VSH.js";import{$ as B,Ab as A,Bb as G,Ca as d,Cb as J,Da as w,Q as q,Qa as z,Ta as f,V as C,Va as s,Wb as U,Xa as F,Z as D,Zb as Y,_ as W,cb as r,db as t,eb as I,ha as u,ia as y,ib as x,jb as k,kb as M,oa as P,pc as K,qa as R,rb as h,sb as l,uc as j,wb as v,xb as _,yb as b,zb as H}from"./chunk-QG64PWEM.js";var be=(()=>{class i{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new R;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(c,n,o,e,m){this.el=c,this.ngModel=n,this.control=o,this.cd=e,this.config=m}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(c){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(c){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(c||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||i)(w(P),w(N,8),w(Z,8),w(U),w(re))};static \u0275dir=B({type:i,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(n,o){n&1&&k("input",function(m){return o.onInput(m)}),n&2&&F("p-filled",o.filled)("p-inputtextarea-resizable",o.autoResize)("p-variant-filled",o.variant==="filled"||o.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",Y],variant:"variant"},outputs:{onResize:"onResize"},features:[z]})}return i})(),Ce=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=W({type:i});static \u0275inj=q({imports:[j]})}return i})();var Se=()=>({width:"100%",right:"0",left:"0"}),Ee=i=>({"920px":i});function Te(i,p){i&1&&(r(0,"small",48),l(1,"Employee is required"),t())}function Ie(i,p){i&1&&(r(0,"small"),l(1,"Contact is required"),t())}function je(i,p){i&1&&(r(0,"small"),l(1,"Contact number must be 10 digits"),t())}function Ne(i,p){if(i&1&&(r(0,"div",48),f(1,Ie,2,0,"small",49),I(2,"br"),f(3,je,2,0,"small",49),I(4,"br"),t()),i&2){M();let c=h(32);d(),s("ngIf",c.control.getError("required")),d(2),s("ngIf",c.control.getError("minlength"))}}function xe(i,p){i&1&&(r(0,"small",48),l(1,"Parent Category is required"),t())}function Oe(i,p){i&1&&(r(0,"small",48),l(1,"Child Category is required"),t())}function Le(i,p){if(i&1){let c=x();r(0,"div",21)(1,"label",50),l(2,"Child Category"),t(),r(3,"p-dropdown",51,6),b("ngModelChange",function(o){u(c);let e=M();return _(e.ticketObj.childCategoryId,o)||(e.ticketObj.childCategoryId=o),y(o)}),t(),f(5,Oe,2,0,"small",24),t()}if(i&2){let c=h(4),n=M();d(3),v("ngModel",n.ticketObj.childCategoryId),s("options",n.categoryList1),d(2),s("ngIf",c.invalid&&(c.dirty||c.touched))}}function Ve(i,p){i&1&&(r(0,"small",48),l(1,"Department is required"),t())}function qe(i,p){i&1&&(r(0,"small",48),l(1,"Severity is required"),t())}function De(i,p){i&1&&(r(0,"small"),l(1,"Request Details is required"),t())}function We(i,p){if(i&1&&(r(0,"div",48),f(1,De,2,0,"small",49),t()),i&2){M();let c=h(73);d(),s("ngIf",c.control.getError("required"))}}var ht=(()=>{let p=class p{constructor(){this.ticketObj=new V,this.user=JSON.parse(localStorage.getItem("user")||""),this.empList$=[],this.deptlist$=[],this.pCategoryList=[],this.categoryList=[],this.categoryList1=[],this.loading=!1,this.message=C(L),this.confirm=C(O),this.router=C(Q),this.ticket=C(ce),this.employee=C(de),this.dept=C(ue),this.category=C(_e)}ngOnInit(){this.ticketObj.createdByEmployee=this.user._id,this.getEmpList(),this.getDept(),this.getPcategory(),this.getCategory()}pchange(){this.categoryList1=this.categoryList;let n=this.categoryList1.filter(e=>e.parentCategoryId===this.ticketObj.parentCategoryId);this.categoryList1=n;let o=this.pCategoryList.find(e=>e.id===this.ticketObj.parentCategoryId);this.ticketObj.deptId=o?o.deptId:""}getEmpList(){this.employee.getEmployees().subscribe(n=>{n.result?this.empList$=n.data.map(o=>({id:o._id,name:o.name})):this.message.add({severity:"error",summary:"Error",detail:n.message})})}getDept(){this.dept.getDept().subscribe(n=>{n.result?this.deptlist$=n.data.map(o=>({id:o._id,name:o.deptName})):this.message.add({severity:"error",summary:"Error",detail:n.message})})}getPcategory(){this.category.getParentCategories().subscribe(n=>{n.result?this.pCategoryList=n.data.map(o=>({id:o._id,name:o.categoryName,deptId:o.deptId})):this.message.add({severity:"error",summary:"Error",detail:n.message})})}getCategory(){this.category.getChildCategories().subscribe(n=>{n.result?this.categoryList=n.data.map(o=>({id:o._id,name:o.categoryName,parentCategoryId:o.parentCategoryId})):this.message.add({severity:"error",summary:"Error",detail:n.message})})}reset(){this.ticketObj=new V,this.ticketObj.createdByEmployee=this.user._id}onSubmit(){this.confirm.confirm({message:"Are you sure you want to submit this Ticket?",header:"Confirm",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.loading=!1,this.ticket.createTicket(this.ticketObj).subscribe({next:n=>{n.result?(this.message.add({severity:"success",summary:"Success",detail:"Ticket Created Successfully"}),setTimeout(()=>{this.router.navigateByUrl("pages/tickets")},1e3)):(this.loading=!1,this.message.add({severity:"error",summary:"Error",detail:n.message}))},error:n=>{if(this.message.add({severity:"error",summary:"error",detail:n.error.message}),n.error.data)for(let o of n.error.data)this.message.add({severity:"error",summary:"error",detail:o.msg+" "+o.path})}})},reject:()=>{this.loading=!1,this.message.add({severity:"info",summary:"info",detail:"Submit cancelled"})}})}};p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=D({type:p,selectors:[["app-new-ticket"]],standalone:!0,features:[H([L,O]),A],decls:80,vars:30,consts:[["name","ngModel"],["contact","ngModel"],["pcategory","ngModel"],["department","ngModel"],["severity","ngModel"],["request","ngModel"],["categoryv","ngModel"],[3,"breakpoints"],[1,"col-md-12","flex","flex-row","align-item-center","justify-content-between"],[1,"flex","flex-column","gap-2"],[1,"text-900","font-medium","text-3xl"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/pages/dashboard",1,"text-decoration-none","text-900","font-medium"],["routerLink","/pages/new-ticket",1,"text-decoration-none","text-900","font-medium"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-12","mt-4"],[1,"card"],[1,"card-body"],[1,"row"],[1,"p-fluid","p-formgrid","p-2"],[1,"field","col-md-6","col-sm-12"],["for","name"],["id","cemp","optionLabel","name","optionValue","id","ngModel","","required","",3,"ngModelChange","ngModel","options","disabled"],["class","p-error",4,"ngIf"],["for","contact_no"],["id","contact_no","type","number","placeholder","123456789","ngModel","","required","","minlength","10",3,"ngModelChange","ngModel","useGrouping"],["for","pcategory"],["id","pcategory","placeholder","Select Parent Category","optionLabel","name","optionValue","id","ngModel","","required","",3,"ngModelChange","onChange","ngModel","options"],["class","field col-md-6 col-sm-12",4,"ngIf"],["for","department"],["id","department","optionLabel","name","optionValue","id","placeholder","Select department","ngModel","","required","",3,"ngModelChange","ngModel","options"],["id","severity",1,"field","col-md-6","col-sm-12","align-content-center"],["for","severity",1,"pb-1"],[1,"d-flex","flex-wrap","align-item-center","justify-content-start","gap-5","col-md-12","ml-3"],[1,"severity"],["type","radio","name","low","value","Low","ngModel","","required","",1,"form-check-input","border","border-secondary",3,"ngModelChange","ngModel","checked"],["for","low",1,"form-check-label"],["type","radio","name","medium","value","Medium","ngModel","","required","",1,"form-check-input","border","border-secondary",3,"ngModelChange","ngModel","checked"],["for","medium",1,"form-check-label"],["type","radio","name","high","value","High","ngModel","","required","",1,"form-check-input","border","border-secondary",3,"ngModelChange","ngModel","checked"],["for","female",1,"form-check-label"],[1,"field","col-md-12","col-sm-12"],["for","requestDetails"],["id","requestDetails","rows","5","cols","30","pInputTextarea","","ngModel","","required","",3,"ngModelChange","ngModel"],[1,"flex","align-item-center","justify-content-end","gap-3","mt-2","col-md-12","col-sm-12"],["severity","secondary",3,"onClick","raised"],[3,"onClick","loading","disabled"],[1,"p-error"],[4,"ngIf"],["for","category"],["id","category","placeholder","Select category","optionLabel","name","optionValue","id","ngModel","","required","",3,"ngModelChange","ngModel","options"]],template:function(o,e){if(o&1){let m=x();r(0,"main"),I(1,"p-toast",7)(2,"p-confirmDialog"),r(3,"div",8)(4,"div",9)(5,"span",10),l(6,"New Ticket"),t(),r(7,"ol",11)(8,"li",12)(9,"a",13),l(10,"Home"),t()(),r(11,"li",12)(12,"a",14),l(13,"New Ticket"),t()(),r(14,"li",15),l(15,"Add"),t()()()(),r(16,"div",16)(17,"div",17)(18,"div",18)(19,"div",19)(20,"div",20)(21,"div",19)(22,"div",21)(23,"label",22),l(24,"Name"),t(),r(25,"p-dropdown",23,0),b("ngModelChange",function(a){return u(m),_(e.ticketObj.createdByEmployee,a)||(e.ticketObj.createdByEmployee=a),y(a)}),t(),f(27,Te,2,0,"small",24),t(),r(28,"div",21)(29,"label",25),l(30,"Contact No "),t(),r(31,"p-inputNumber",26,1),b("ngModelChange",function(a){return u(m),_(e.ticketObj.contactNo,a)||(e.ticketObj.contactNo=a),y(a)}),t(),f(33,Ne,5,2,"div",24),t()(),r(34,"div",19)(35,"div",21)(36,"label",27),l(37,"Parent Category"),t(),r(38,"p-dropdown",28,2),b("ngModelChange",function(a){return u(m),_(e.ticketObj.parentCategoryId,a)||(e.ticketObj.parentCategoryId=a),y(a)}),k("onChange",function(){return u(m),y(e.pchange())}),t(),f(40,xe,2,0,"small",24),t(),f(41,Le,6,3,"div",29),t(),r(42,"div",19)(43,"div",21)(44,"label",30),l(45,"Department"),t(),r(46,"p-dropdown",31,3),b("ngModelChange",function(a){return u(m),_(e.ticketObj.deptId,a)||(e.ticketObj.deptId=a),y(a)}),t(),f(48,Ve,2,0,"small",24),t(),r(49,"div",32)(50,"label",33),l(51,"Priority"),t(),r(52,"div",34)(53,"div",35)(54,"input",36,4),b("ngModelChange",function(a){return u(m),_(e.ticketObj.severity,a)||(e.ticketObj.severity=a),y(a)}),t(),r(56,"label",37),l(57," \xA0 Low "),t()(),r(58,"div",35)(59,"input",38,4),b("ngModelChange",function(a){return u(m),_(e.ticketObj.severity,a)||(e.ticketObj.severity=a),y(a)}),t(),r(61,"label",39),l(62," \xA0 Medium "),t()(),r(63,"div",35)(64,"input",40,4),b("ngModelChange",function(a){return u(m),_(e.ticketObj.severity,a)||(e.ticketObj.severity=a),y(a)}),t(),r(66,"label",41),l(67," \xA0 High "),t()()(),f(68,qe,2,0,"small",24),t()(),r(69,"div",42)(70,"label",43),l(71,"Request Details"),t(),r(72,"textarea",44,5),b("ngModelChange",function(a){return u(m),_(e.ticketObj.requestDetails,a)||(e.ticketObj.requestDetails=a),y(a)}),t(),f(74,We,2,1,"div",24),t(),r(75,"div",45)(76,"p-button",46),k("onClick",function(){return u(m),y(e.reset())}),l(77,"Reset"),t(),r(78,"p-button",47),k("onClick",function(){return u(m),y(e.onSubmit())}),l(79,"Submit"),t()()()()()()()()}if(o&2){let m=h(26),g=h(32),a=h(39),S=h(47),E=h(55),T=h(73);d(),s("breakpoints",J(28,Ee,G(27,Se))),d(24),v("ngModel",e.ticketObj.createdByEmployee),s("options",e.empList$)("disabled",!0),d(2),s("ngIf",m.invalid&&(m.dirty||m.touched)),d(4),v("ngModel",e.ticketObj.contactNo),s("useGrouping",!1),d(2),s("ngIf",g.invalid&&(g.dirty||g.touched)),d(5),v("ngModel",e.ticketObj.parentCategoryId),s("options",e.pCategoryList),d(2),s("ngIf",a.invalid&&(a.dirty||a.touched)),d(),s("ngIf",e.categoryList1.length>0),d(5),v("ngModel",e.ticketObj.deptId),s("options",e.deptlist$),d(2),s("ngIf",S.invalid&&(S.dirty||S.touched)),d(6),v("ngModel",e.ticketObj.severity),s("checked",e.ticketObj.severity==="low"),d(5),v("ngModel",e.ticketObj.severity),s("checked",e.ticketObj.severity==="medium"),d(5),v("ngModel",e.ticketObj.severity),s("checked",e.ticketObj.severity==="high"),d(4),s("ngIf",E.invalid&&(E.dirty||E.touched)),d(4),v("ngModel",e.ticketObj.requestDetails),d(2),s("ngIf",T.invalid&&(T.dirty||T.touched)),d(2),s("raised",!0),d(2),s("loading",e.loading)("disabled",m.invalid||g.invalid||a.invalid||S.invalid||E.invalid||T.invalid)}},dependencies:[j,K,me,se,ve,he,ae,ne,X,ee,$,te,ie,N,oe,ge,pe,fe,ye,Ce,be,le]});let i=p;return i})();export{ht as NewTicketComponent};
